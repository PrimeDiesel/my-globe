<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>Interactive 3D Globe</title>
  <style>
    body, html {
      margin: 0;
      padding: 0;
      overflow: hidden;
      background: #000;
    }
    #globeViz {
      width: 100vw;
      height: 100vh;
      background: #000;
    }
    #globeModal {
      display: none;
      position: absolute;
      top: 20px;
      left: 20px;
      z-index: 1000;
      background: white;
      padding: 20px;
      border-radius: 12px;
      box-shadow: 0 4px 20px rgba(0,0,0,0.3);
      max-width: 320px;
      font-family: system-ui;
    }
  </style>
</head>
<body>
  <div id="globeViz"></div>
  <div id="globeModal">
    <h3>ğŸŒ <span id="modal-country-name">Country</span></h3>
    <p><strong>é¦–éƒ½:</strong> <span id="modal-capital">â€”</span></p>
    <p><strong>è¯­è¨€:</strong> <span id="modal-language">â€”</span></p>
    <p><strong>æ–‡åŒ–:</strong> <span id="modal-culture">â€”</span></p>
    <button onclick="document.getElementById('globeModal').style.display='none'">å…³é—­</button>
  </div>

  <script src="https://cdn.jsdelivr.net/npm/three@0.159.0/build/three.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/globe.gl@2.35.0/dist/globe.gl.min.js"></script>

  <script>
    // Wait for page to load
    window.onload = function() {
      const globe = Globe()
        .globeMaterial(() => new THREE.MeshPhongMaterial({
          color: '#1e6aa6',
          shininess: 30,
          specular: new THREE.Color('#ffffff'),
          bumpScale: 0.04
        }))
        .bumpImageUrl('https://cdn.jsdelivr.net/npm/three-globe/example/img/earth-topology.png')
        .backgroundImageUrl('https://cdn.jsdelivr.net/npm/three-globe/example/img/night-sky.png')
        .showAtmosphere(true)
        .atmosphereColor('#6ab9ff')
        .atmosphereAltitude(0.12)
        .onGlobeClick((coords) => {
          const clickedCountry = findNearestCountry(coords.lat, coords.lng);
          if (clickedCountry) showCountryInfo(clickedCountry);
        })
        (document.getElementById('globeViz'));

      // Auto-rotate
      let rotationSpeed = 0.001;
      function rotate() {
        globe.rotationY(globe.rotationY() + rotationSpeed);
        requestAnimationFrame(rotate);
      }
      rotate();

      globe.container().addEventListener('mouseenter', () => rotationSpeed = 0);
      globe.container().addEventListener('mouseleave', () => rotationSpeed = 0.001);

      // Zoom
      globe.container().addEventListener('wheel', e => {
        e.preventDefault();
        globe.scale(Math.min(Math.max(150, globe.scale() + (e.deltaY > 0 ? -20 : 20)), 1200));
      });

      // Country data
      const countryDatabase = {
        "USA": { name: "ç¾å›½", capital: "åç››é¡¿", lat: 39.8, lng: -98.6, language: "è‹±è¯­", culture: "ç§‘æŠ€ã€è‡ªç”±ã€å¤šå…ƒ" },
        "CHN": { name: "ä¸­å›½", capital: "åŒ—äº¬", lat: 35.9, lng: 104.2, language: "ä¸­æ–‡", culture: "å†å²ã€ç¾é£Ÿã€ä¼ ç»Ÿ" },
        "JPN": { name: "æ—¥æœ¬", capital: "ä¸œäº¬", lat: 36.2, lng: 138.3, language: "æ—¥è¯­", culture: "åŠ¨æ¼«ã€ç¤¼ä»ªã€æŠ€æœ¯" },
        "FRA": { name: "æ³•å›½", capital: "å·´é»", lat: 46.6, lng: 2.0, language: "æ³•è¯­", culture: "è‰ºæœ¯ã€æµªæ¼«ã€ç¾é£Ÿ" },
        "BRA": { name: "å·´è¥¿", capital: "å·´è¥¿åˆ©äºš", lat: -14.2, lng: -51.9, language: "è‘¡è„ç‰™è¯­", culture: "è¶³çƒã€ç‹‚æ¬¢èŠ‚ã€è‡ªç„¶" },
        "IND": { name: "å°åº¦", capital: "æ–°å¾·é‡Œ", lat: 20.6, lng: 79.0, language: "å°åœ°è¯­", culture: "ç‘œä¼½ã€å®è±åã€é¦™æ–™" },
        "RUS": { name: "ä¿„ç½—æ–¯", capital: "è«æ–¯ç§‘", lat: 61.5, lng: 105.3, language: "ä¿„è¯­", culture: "èŠ­è•¾ã€ä¼ç‰¹åŠ ã€å¥—å¨ƒ" },
        "AUS": { name: "æ¾³å¤§åˆ©äºš", capital: "å ªåŸ¹æ‹‰", lat: -25.3, lng: 133.8, language: "è‹±è¯­", culture: "è¢‹é¼ ã€å†²æµªã€å¤§å ¡ç¤" },
        "CAN": { name: "åŠ æ‹¿å¤§", capital: "æ¸¥å¤ªå", lat: 56.1, lng: -106.3, language: "è‹±è¯­/æ³•è¯­", culture: "æ«å¶ã€å†°çƒã€è‡ªç„¶" },
        "EGY": { name: "åŸƒåŠ", capital: "å¼€ç½—", lat: 26.8, lng: 30.8, language: "é˜¿æ‹‰ä¼¯è¯­", culture: "é‡‘å­—å¡”ã€å°¼ç½—æ²³ã€æ³•è€" }
      };

      function findNearestCountry(lat, lng) {
        let nearest = null, minDist = Infinity;
        for (let [code, c] of Object.entries(countryDatabase)) {
          const dist = Math.hypot(lat - c.lat, lng - c.lng);
          if (dist < minDist && dist < 15) {
            minDist = dist;
            nearest = { ...c, code };
          }
        }
        return nearest;
      }

      function showCountryInfo(c) {
        const m = document.getElementById.bind(document);
        m('modal-country-name').textContent = c.name;
        m('modal-capital').textContent = c.capital;
        m('modal-language').textContent = c.language;
        m('modal-culture').textContent = c.culture;
        m('globeModal').style.display = 'block';
      }

      // Make globe fill screen
      function resize() {
        const el = document.getElementById('globeViz');
        el.style.width = window.innerWidth + 'px';
        el.style.height = window.innerHeight + 'px';
      }
      window.addEventListener('resize', resize);
      resize();
    };
  </script>
</body>
</html>